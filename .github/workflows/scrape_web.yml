name: Telegram Web Scraper (手动运行/上海时区)

on:
  workflow_dispatch:

jobs:
  scrape_and_save:
    runs-on: ubuntu-latest
    
    env:
      TZ: Asia/Shanghai

    steps:
      - name: 检出代码
        uses: actions/checkout@v4

      - name: 设置 Python 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: 安装依赖 (requests, BeautifulSoup, pytz)
        run: pip install -r requirements.txt

      - name: 运行 Web 抓取脚本
        run: python scraper_web.py
        
      - name: 提交生成的 Markdown 文件
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "自动抓取: Telegram Web 内容更新 - ${{ env.TZ }}"
          file_pattern: "*.md"
          commit_options: '--date="$(TZ=${{ env.TZ }} date -u +''%Y-%m-%dT%H:%M:%SZ'')"'
